<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>炼丹炉被黑始末 (a.k.a. 这下服务器变回转寿司了，最美味的一集) - libreliu&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="炼丹炉被黑了，以下是事情经过： 流水账 2024&#x2F;2&#x2F;27：师兄发现在实验室服务器上登陆的网络通被网络信息中心留言： 123456789您好！您使用的IP地址 xxx.xxx.xx.xxx 存在通信异常行为，请尽快对系统进行处理，否则网络信息中心中心将暂停该机的对外通信。科大网络信息中心 (联系方式略)异常行为：xxx.xxx.xx.xx大量查询域名ircx.us.too,怀疑">
<meta property="og:type" content="article">
<meta property="og:title" content="炼丹炉被黑始末 (a.k.a. 这下服务器变回转寿司了，最美味的一集)">
<meta property="og:url" content="https://blog.libreliu.info/intrusion-investigation/">
<meta property="og:site_name" content="libreliu&#39;s blog">
<meta property="og:description" content="炼丹炉被黑了，以下是事情经过： 流水账 2024&#x2F;2&#x2F;27：师兄发现在实验室服务器上登陆的网络通被网络信息中心留言： 123456789您好！您使用的IP地址 xxx.xxx.xx.xxx 存在通信异常行为，请尽快对系统进行处理，否则网络信息中心中心将暂停该机的对外通信。科大网络信息中心 (联系方式略)异常行为：xxx.xxx.xx.xx大量查询域名ircx.us.too,怀疑">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-02-27T16:00:00.000Z">
<meta property="article:modified_time" content="2024-02-27T16:00:00.000Z">
<meta property="article:author" content="Libre Liu">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/css/images/logo.png">
  
  <link href="/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  
<link rel="stylesheet" href="/css/style.css">

  

<meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="libreliu's blog" type="application/atom+xml">
</head>

<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
      <a id="logo" class="logo" href="/"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/paper-summary">Paper Reading</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://blog.libreliu.info"></form>
        </div>
      </nav>
    </div>
  </div>
</header>

    <br>
    <section id="main" class="outer"><article id="post-intrusion-investigation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      炼丹炉被黑始末 (a.k.a. 这下服务器变回转寿司了，最美味的一集)
      <small class=article-detail-date-index>&nbsp; 2024-02-28</small>
    </h1>
  


        <div class=page-title></div>
        <br>
      </header>
    
    <div class="article-meta">
      <!--<a href="/intrusion-investigation/" class="article-date">
  <time datetime="2024-02-27T16:00:00.000Z" itemprop="datePublished">2024-02-28</time>
</a>-->
      <!-- 
--><!-- by blair 160724 -->
      <!-- by blair
      
      -->
    </div>
    <div class="article-entry" itemprop="articleBody">
      
      
      
        <p>炼丹炉被黑了，以下是事情经过：</p>
<h2 id="流水账"><a href="#流水账" class="headerlink" title="流水账"></a>流水账</h2><ul>
<li><p>2024&#x2F;2&#x2F;27：师兄发现在实验室服务器上登陆的网络通被网络信息中心留言：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">您好！</span><br><span class="line"></span><br><span class="line">您使用的IP地址 xxx.xxx.xx.xxx 存在通信异常行为，</span><br><span class="line">请尽快对系统进行处理，否则网络信息中心中心将暂停该机的对外通信。</span><br><span class="line"></span><br><span class="line">科大网络信息中心 (联系方式略)</span><br><span class="line"></span><br><span class="line">异常行为：</span><br><span class="line">xxx.xxx.xx.xx大量查询域名ircx.us.too,怀疑该IP已被入侵并被远程控制。</span><br></pre></td></tr></table></figure>
<p>留言共有两条：分别为 2024&#x2F;2&#x2F;21 20:44 和 2024&#x2F;2&#x2F;27 09:31 所留，均提示高频的 IRC 服务器域名 DNS 查询。</p>
<p>我简单用 <code>tcpdump -i lo port 53</code> 看了一下，发现了一秒钟多次的 DNS 查询。因为使用了 <code>systemd-resolved</code>，DNS 服务器为 systemd 的 127.0.0.53，故可以在本地回环链路上观察到。</p>
<p>经过观察，主要有到 <code>ircx.us.to</code>, <code>irc.dal.net</code>, <code>irc.undernet.org</code> 三个域名的查询，每秒查询超过 100 次。</p>
<p>显然，服务器应该是被黑了。</p>
</li>
<li><p>2024&#x2F;2&#x2F;28：在 @taoky 的帮助下进行了比较详尽的调查，花费了一个晚上。</p>
</li>
</ul>
<h2 id="情况介绍"><a href="#情况介绍" class="headerlink" title="情况介绍"></a>情况介绍</h2><p>该服务器位于科大校园网内，以 100Mbps 以太网链路接入管科楼，拥有学校的 IPv4 和 IPv6 地址，没有专门的网络通，需要上网时同学会登陆自己的网络通账号。</p>
<p>服务器为 Ubuntu 20.04 LTS，插有 10 (9?) 块 RTX3090 显卡。平常同学们通过 ssh 公钥登陆，或通过 (密码 + TOTP Code) 进行登陆（采用 <code>libpam-google-authenticator</code>，参考 <a target="_blank" rel="noopener" href="https://ubuntu.com/tutorials/configure-ssh-2fa#2-installing-and-configuring-required-packages">link</a>）。</p>
<p>服务器共有 25 个用户，其中 5 个拥有 sudo 权限，3 个位于 docker 组。Docker daemon 运行在 root。</p>
<p>利用 <code>netstat -nlp</code> 可以看到上面有 pgyvpn，ZeroTier 等程序。</p>
<h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>大概的分析时间线如下：</p>
<h3 id="确定哪个进程在发出-DNS-请求"><a href="#确定哪个进程在发出-DNS-请求" class="headerlink" title="确定哪个进程在发出 DNS 请求"></a>确定哪个进程在发出 DNS 请求</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ sudo netstat -np | grep 127.0.0.53:53 | grep udp</span><br><span class="line">udp        0      0 127.0.0.1:41511         127.0.0.53:53           ESTABLISHED -                   </span><br><span class="line">udp      768      0 127.0.0.1:43814         127.0.0.53:53           ESTABLISHED 5973/./nobody       </span><br><span class="line">udp        0      0 127.0.0.1:44384         127.0.0.53:53           ESTABLISHED -                   </span><br><span class="line">udp        0      0 127.0.0.1:46012         127.0.0.53:53           ESTABLISHED 1989649/[           </span><br><span class="line">udp      768      0 127.0.0.1:52710         127.0.0.53:53           ESTABLISHED 5975/./nobody       </span><br><span class="line">udp        0      0 127.0.0.1:55295         127.0.0.53:53           ESTABLISHED 1989647/[           </span><br><span class="line">udp      768      0 127.0.0.1:55728         127.0.0.53:53           ESTABLISHED 5976/./nobody       </span><br><span class="line">udp        0      0 127.0.0.1:55801         127.0.0.53:53           ESTABLISHED 1986059/[kwor       </span><br><span class="line">udp        0      0 127.0.0.1:56095         127.0.0.53:53           ESTABLISHED -                   </span><br><span class="line">udp        0      0 127.0.0.1:57082         127.0.0.53:53           ESTABLISHED 2178005/[           </span><br><span class="line">udp        0      0 127.0.0.1:58772         127.0.0.53:53           ESTABLISHED -                   </span><br><span class="line">udp        0      0 127.0.0.1:59061         127.0.0.53:53           ESTABLISHED 1995387/[           </span><br><span class="line">udp        0      0 127.0.0.1:59165         127.0.0.53:53           ESTABLISHED 1986012/[           </span><br><span class="line">udp        0      0 127.0.0.1:60684         127.0.0.53:53           ESTABLISHED -                   </span><br></pre></td></tr></table></figure>

<p>可以看到怀疑对象有 PID 为 5976 和 1989649 等几个进程。</p>
<p>不过，登登登登：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ps aux | grep 5975</span><br><span class="line">lzt        40314  0.0  0.0  19764  2856 pts/11   S+   22:41   0:00 grep --color=auto 5975</span><br></pre></td></tr></table></figure>

<p>这要拜 Rootkit 所赐，因为 <code>/etc/ld.so.preload</code> 里面加入了一些内容。不过也没事，可以用静态链接的 busybox 来看：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ./busybox cat /etc/ld.so.preload</span><br><span class="line">/usr/local/lib/dbus-collector/libdbus_x86_64.so</span><br><span class="line">/usr/local/lib/network.so</span><br><span class="line">$ sudo ./busybox ps aux | grep 5975</span><br><span class="line"> 5975 zx        5:43 ./nobody nmop</span><br><span class="line">44054 lzt       0:00 grep --color=auto 5975</span><br><span class="line">$ sudo ./busybox readlink -f /proc/5975/exe</span><br><span class="line">/home/zx/.cpan/nobody</span><br></pre></td></tr></table></figure>

<p>仔细检查，共有下面的用户拥有 .cpan：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/home/spf/.cpan</span><br><span class="line">/home/xy/.cpan</span><br><span class="line">/home/zx/.cpan</span><br></pre></td></tr></table></figure>

<p>另外观察一下另外几个进程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ./busybox readlink -f /proc/1986059/exe</span><br><span class="line">/usr/bin/crond</span><br><span class="line">$ sudo ./busybox readlink -f /proc/1989647/exe</span><br><span class="line">/usr/bin/a</span><br><span class="line"># 下同</span><br></pre></td></tr></table></figure>

<h2 id="cron-日志暴露的内容"><a href="#cron-日志暴露的内容" class="headerlink" title="cron 日志暴露的内容"></a>cron 日志暴露的内容</h2><p>另外，在 journalctl 的 cron 条目里面可以额外发现一些信息：</p>
<details>
  <summary>太长了，点这里观看</summary>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">2月 28 22:53:01 GPU crontab[62015]: (yyy) LIST (yyy)</span><br><span class="line">2月 28 22:54:01 GPU crontab[63492]: (yyy) LIST (yyy)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65423]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65424]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65427]: (root) CMD (/root/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65426]: pam_unix(cron:session): session opened for user yyy by (uid=0)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65425]: pam_unix(cron:session): session opened for user xy by (uid=0)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65428]: (root) CMD (/.dbus/auto &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65429]: (yyy) CMD (/dev/shm/.m-1013/dbus-collector.seed)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65430]: (xy) CMD (/home/xy/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65423]: pam_unix(cron:session): session closed for user root</span><br><span class="line">2月 28 22:55:01 GPU CRON[65424]: pam_unix(cron:session): session closed for user root</span><br><span class="line">2月 28 22:55:01 GPU crontab[65438]: (yyy) LIST (yyy)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65425]: pam_unix(cron:session): session closed for user xy</span><br><span class="line">2月 28 22:55:01 GPU CRON[65426]: (CRON) info (No MTA installed, discarding output)</span><br><span class="line">2月 28 22:55:01 GPU CRON[65426]: pam_unix(cron:session): session closed for user yyy</span><br><span class="line">2月 28 22:56:01 GPU CRON[67335]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67338]: (root) CMD (/.dbus/auto &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67334]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67339]: (root) CMD (/root/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67336]: pam_unix(cron:session): session opened for user xy by (uid=0)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67337]: pam_unix(cron:session): session opened for user yyy by (uid=0)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67340]: (xy) CMD (/home/xy/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67342]: (yyy) CMD (/dev/shm/.m-1013/dbus-collector.seed)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67334]: pam_unix(cron:session): session closed for user root</span><br><span class="line">2月 28 22:56:01 GPU CRON[67335]: pam_unix(cron:session): session closed for user root</span><br><span class="line">2月 28 22:56:01 GPU CRON[67336]: pam_unix(cron:session): session closed for user xy</span><br><span class="line">2月 28 22:56:01 GPU crontab[67351]: (yyy) LIST (yyy)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67337]: (CRON) info (No MTA installed, discarding output)</span><br><span class="line">2月 28 22:56:01 GPU CRON[67337]: pam_unix(cron:session): session closed for user yyy</span><br><span class="line">2月 28 22:57:01 GPU CRON[69563]: pam_unix(cron:session): session opened for user yyy by (uid=0)</span><br><span class="line">2月 28 22:57:01 GPU CRON[69561]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">2月 28 22:57:01 GPU CRON[69564]: (yyy) CMD (/dev/shm/.m-1013/dbus-collector.seed)</span><br><span class="line">2月 28 22:57:01 GPU CRON[69562]: pam_unix(cron:session): session opened for user xy by (uid=0)</span><br><span class="line">2月 28 22:57:01 GPU CRON[69560]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">2月 28 22:57:01 GPU CRON[69565]: (root) CMD (/.dbus/auto &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:57:01 GPU CRON[69566]: (xy) CMD (/home/xy/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:57:01 GPU CRON[69567]: (root) CMD (/root/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:57:01 GPU CRON[69562]: pam_unix(cron:session): session closed for user xy</span><br><span class="line">2月 28 22:57:01 GPU CRON[69560]: pam_unix(cron:session): session closed for user root</span><br><span class="line">2月 28 22:57:01 GPU CRON[69561]: pam_unix(cron:session): session closed for user root</span><br><span class="line">2月 28 22:57:01 GPU CRON[69563]: (CRON) info (No MTA installed, discarding output)</span><br><span class="line">2月 28 22:57:01 GPU CRON[69563]: pam_unix(cron:session): session closed for user yyy</span><br><span class="line">2月 28 22:58:01 GPU CRON[70918]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">2月 28 22:58:01 GPU CRON[70917]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">2月 28 22:58:01 GPU CRON[70919]: pam_unix(cron:session): session opened for user xy by (uid=0)</span><br><span class="line">2月 28 22:58:01 GPU CRON[70920]: pam_unix(cron:session): session opened for user yyy by (uid=0)</span><br><span class="line">2月 28 22:58:01 GPU CRON[70921]: (root) CMD (/.dbus/auto &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:58:01 GPU CRON[70923]: (xy) CMD (/home/xy/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:58:01 GPU CRON[70922]: (root) CMD (/root/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">2月 28 22:58:01 GPU CRON[70924]: (yyy) CMD (/dev/shm/.m-1013/dbus-collector.seed)</span><br><span class="line">2月 28 22:58:01 GPU CRON[70919]: pam_unix(cron:session): session closed for user xy</span><br><span class="line">2月 28 22:58:01 GPU CRON[70918]: pam_unix(cron:session): session closed for user root</span><br></pre></td></tr></table></figure>

</details>

<p>这里可以额外看到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/dev/shm/.m-1013/dbus-collector.seed</span><br><span class="line">/root/.cpan/.cache/update</span><br><span class="line">/.dbus/auto</span><br></pre></td></tr></table></figure>

<p>三个脚本。</p>
<h2 id="用户账户的信息"><a href="#用户账户的信息" class="headerlink" title="用户账户的信息"></a>用户账户的信息</h2><p>可以看到被篡改的 <code>passwd</code> 和 <code>group</code>；木马甚至贴心的留了 <code>passwd-</code> 和 <code>group-</code> 作为备份…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ diff /etc/passwd /etc/passwd-</span><br><span class="line">78d77</span><br><span class="line">&lt; ghost:x:0:0::/:/bin/bash</span><br><span class="line">$ diff /etc/group /etc/group-</span><br><span class="line">1c1</span><br><span class="line">&lt; root:x:0:</span><br><span class="line">---</span><br><span class="line">&gt; root:x:0:bin</span><br><span class="line">21c21</span><br><span class="line">&lt; sudo:x:27:omnisky,chz,lzt,gjf,hy,nobody,bin</span><br><span class="line">---</span><br><span class="line">&gt; sudo:x:27:omnisky,chz,lzt,gjf,hy,nobody</span><br></pre></td></tr></table></figure>

<p><code>lastlog</code> 中提供了一些登陆信息。其中 <code>ghost</code> (a.k.a. <code>root</code>) 账户于 2 月 26 日被另一科大 IP 地址的主机登陆。由网络信息中心的相关老师查询得知上面登陆着其它 lab 的网络通。</p>
<p><code>ghost            pts/2    xxx.xxx.xxx.xx   一 2月 26 02:42:02 +0800 2024</code></p>
<blockquote>
<p>与 root 时间相同。</p>
</blockquote>
<h2 id="日志和文件修改时间"><a href="#日志和文件修改时间" class="headerlink" title="日志和文件修改时间"></a>日志和文件修改时间</h2><p>syslog 已经被 rotate, auth.log 被 rotate 或者被入侵程序删除了。</p>
<p>auth 里面可以发现 1 月 28 号就有 crontab 活动了：</p>
<details>
  <summary>太长了，点这里观看</summary>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Jan 28 00:00:01 GPU CRON[524365]: pam_unix(cron:session): session opened for user root by (uid=0)</span><br><span class="line">Jan 28 00:00:01 GPU CRON[524366]: pam_unix(cron:session): session opened for user xy by (uid=0)</span><br><span class="line">Jan 28 00:00:01 GPU CRON[524367]: pam_unix(cron:session): session opened for user zx by (uid=0)</span><br><span class="line">Jan 28 00:00:01 GPU CRON[524368]: pam_unix(cron:session): session opened for user zx by (uid=0)</span><br><span class="line">Jan 28 00:00:01 GPU CRON[524369]: pam_unix(cron:session): session opened for user spf by (uid=0)</span><br><span class="line">Jan 28 00:00:01 GPU CRON[524365]: pam_unix(cron:session): session closed for user root</span><br><span class="line">Jan 28 00:00:01 GPU CRON[524366]: pam_unix(cron:session): session closed for user xy</span><br><span class="line">Jan 28 00:00:01 GPU CRON[524367]: pam_unix(cron:session): session closed for user zx</span><br><span class="line">Jan 28 00:00:01 GPU CRON[524368]: pam_unix(cron:session): session closed for user zx</span><br><span class="line">Jan 28 00:00:01 GPU CRON[524369]: pam_unix(cron:session): session closed for user spf</span><br></pre></td></tr></table></figure>

</details>

<h2 id="其他异常文件"><a href="#其他异常文件" class="headerlink" title="其他异常文件"></a>其他异常文件</h2><p>根目录多了很多花里胡哨的东西。</p>
<details>
  <summary>太长了，点这里观看</summary>


<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ ./busybox ls -alh /</span><br><span class="line">total 13M    </span><br><span class="line">drwxr-xr-x   26 root     root        4.0K Feb 28 11:22 .</span><br><span class="line">drwxr-xr-x   26 root     root        4.0K Feb 28 11:22 ..</span><br><span class="line">drwxr-xr-x    3 10000    jyx         4.0K Feb 25 17:28 .dbus</span><br><span class="line">lrwxrwxrwx    1 root     root           7 Jan 10  2023 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x    4 root     root        4.0K Dec  1  2019 boot</span><br><span class="line">drwxr-xr-x    2 root     root        4.0K Dec  1  2019 cdrom</span><br><span class="line">drwxr-xr-x   11 root     root        4.0K Dec  1  2019 data</span><br><span class="line">drwxr-xr-x   24 root     root        4.0K Dec  1  2019 data1</span><br><span class="line">drwxr-xr-x    4 root     root        4.0K Dec  1  2019 data2</span><br><span class="line">drwxr-xr-x   19 root     root        5.6K Dec  1  2019 dev</span><br><span class="line">drwxr-xr-x  149 root     root       12.0K Feb 28 23:44 etc</span><br><span class="line">-rw-r--r--    1 root     root        8.6M Feb 25 17:03 good</span><br><span class="line">drwxr-xr-x   31 root     root        4.0K Feb 28 10:21 home</span><br><span class="line">-rwxr-xr-x    1 root     root       61.4K Dec  1  2019 kwk</span><br><span class="line">lrwxrwxrwx    1 root     root           7 Jan 10  2023 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx    1 root     root           9 Jan 10  2023 lib32 -&gt; usr/lib32</span><br><span class="line">lrwxrwxrwx    1 root     root           9 Jan 10  2023 lib64 -&gt; usr/lib64</span><br><span class="line">lrwxrwxrwx    1 root     root          10 Jan 10  2023 libx32 -&gt; usr/libx32</span><br><span class="line">drwx------    2 root     root       16.0K Dec  1  2019 lost+found</span><br><span class="line">drwxr-xr-x    3 root     root        4.0K Dec  1  2019 media</span><br><span class="line">drwxr-xr-x    2 root     root        4.0K Dec  1  2019 mnt</span><br><span class="line">-rwxr-xr-x    1 root     root        4.0M Dec  1  2019 mx</span><br><span class="line">drwxr-xr-x   24 root     root        4.0K Dec  1  2019 old_os</span><br><span class="line">drwxr-xr-x    7 root     root        4.0K Dec  1  2019 opt</span><br><span class="line">dr-xr-xr-x 1422 root     root           0 Dec  1  2019 proc</span><br><span class="line">drwx------   12 root     root        4.0K Feb 28 23:44 root</span><br><span class="line">drwxr-xr-x   39 root     root        1.3K Feb 29 00:29 run</span><br><span class="line">lrwxrwxrwx    1 root     root           8 Jan 10  2023 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x   11 root     root        4.0K Dec  1  2019 snap</span><br><span class="line">drwxr-xr-x    2 root     root        4.0K Dec  1  2019 srv</span><br><span class="line">dr-xr-xr-x   13 root     root           0 Dec  1  2019 sys</span><br><span class="line">drwxrwxrwt  647 root     root      148.0K Feb 29 00:30 tmp</span><br><span class="line">drwxr-xr-x   14 root     root        4.0K Dec  1  2019 usr</span><br><span class="line">drwxr-xr-x   16 root     root        4.0K Dec  1  2019 var</span><br><span class="line">drwxrwxr-x    2 root     root        4.0K Feb 28 11:26 x</span><br></pre></td></tr></table></figure>

</details>

<p>多了 <code>/x</code>，<code>/mx</code> 和 <code>/kwk</code>，<code>/good</code>，<code>/.dbus</code>。</p>
<h2 id="crontab-分析"><a href="#crontab-分析" class="headerlink" title="crontab 分析"></a>crontab 分析</h2><details>
  <summary>太长了，点这里观看</summary>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ls -alh /var/spool/cron/crontabs/</span><br><span class="line">total 28K</span><br><span class="line">drwx-wx--T 2 root crontab 4.0K 2月  26 13:57 .</span><br><span class="line">drwxr-xr-x 3 root root    4.0K 8月  31  2022 ..</span><br><span class="line">-rw------- 1 root crontab  291 2月  25 17:28 root</span><br><span class="line">-rw------- 1 spf  crontab  277 2月  17  2023 spf</span><br><span class="line">-rw------- 1 xy   crontab  233 2月  17  2023 xy</span><br><span class="line">-rw------- 1 yyy  crontab  261 2月  26 13:57 yyy</span><br><span class="line">-rw------- 1 zx   crontab  343 2月  20  2023 zx</span><br><span class="line">$ sudo cat /var/spool/cron/crontabs/yyy</span><br><span class="line"># DO NOT EDIT THIS FILE - edit the master and reinstall.</span><br><span class="line"># (- installed on Mon Feb 26 13:57:19 2024)</span><br><span class="line"># (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)</span><br><span class="line"># DO NOT REMOVE THIS LINE. dbus-kernel</span><br><span class="line">* * * * * /dev/shm/.m-1013/dbus-collector.seed</span><br><span class="line">$ sudo cat /var/spool/cron/crontabs/root</span><br><span class="line"># DO NOT EDIT THIS FILE - edit the master and reinstall.</span><br><span class="line"># (/tmp/crontab.ZblArV/crontab installed on Sun Feb 25 17:28:18 2024)</span><br><span class="line"># (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)</span><br><span class="line">* * * * * /.dbus/auto &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">* * * * * /root/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">$ sudo cat /var/spool/cron/crontabs/zx</span><br><span class="line"># DO NOT EDIT THIS FILE - edit the master and reinstall.</span><br><span class="line"># (.autobotchk1676891606017226.97733 installed on Mon Feb 20 19:13:26 2023)</span><br><span class="line"># (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)</span><br><span class="line">0,10,20,30,40,50 * * * * /home/zx/.cpan/dumb.botchk &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">0,10,20,30,40,50 * * * * /home/zx/.cpan/nmop.botchk &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">$ sudo cat /var/spool/cron/crontabs/spf</span><br><span class="line"># DO NOT EDIT THIS FILE - edit the master and reinstall.</span><br><span class="line"># (.autobotchk1676636637503791.1778717 installed on Fri Feb 17 20:23:57 2023)</span><br><span class="line"># (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)</span><br><span class="line">0,10,20,30,40,50 * * * * /home/spf/.cpan/spf.botchk &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">$ sudo cat /var/spool/cron/crontabs/xy</span><br><span class="line"># DO NOT EDIT THIS FILE - edit the master and reinstall.</span><br><span class="line"># (cron installed on Fri Feb 17 18:26:23 2023)</span><br><span class="line"># (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)</span><br><span class="line">* * * * * /home/xy/.cpan/.cache/update &gt;/dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure>

</details>

<p>其中 <code>/home/xy/.cpan/.cache/update</code> 脚本的内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">if test -r /home/xy/.cpan/.cache/mech.pid; then</span><br><span class="line">pid=$(cat /home/xy/.cpan/.cache/mech.pid)</span><br><span class="line">if $(kill -CHLD $pid &gt;/dev/null 2&gt;&amp;1)</span><br><span class="line">then</span><br><span class="line">exit 0</span><br><span class="line">fi</span><br><span class="line">fi</span><br><span class="line">cd /home/xy/.cpan/.cache</span><br><span class="line">./run &amp;&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p>其实就是调用 run 的，然后 run 来启动 botnet 的客户端。</p>
<h2 id="功能分析"><a href="#功能分析" class="headerlink" title="功能分析"></a>功能分析</h2><blockquote>
<p>Special thanks to @taoky.</p>
</blockquote>
<ul>
<li><code>/kwk</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/6e4d58a1fe5d7add270d5819ac8e8c17a0aff8d928be185d563b569759972979">VirusTotal</a><ul>
<li>会把自己假装成 <code>[kworker/0:0]</code></li>
<li>作为 IRCBot 连接到 <code>#ddoser</code> 频道</li>
</ul>
</li>
<li><code>/mx</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/c21368ef860eaef0ac1c259f1fb584ab752044824021d8ca9455b41c44f2b08a">VirusTotal</a><ul>
<li>加壳了的 golang 程序</li>
</ul>
</li>
<li><code>/good</code> 是个 tar.gz，里面看起来是那个 “dbus” 程序，可以用来挖门罗币<ul>
<li><code>README</code>: <del>最担心你不会用恶意软件的一集</del><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">(: I MAKE THIS FOR FREE, SHARE IT IF YOU LIKE :)</span><br><span class="line">  ==========================================</span><br><span class="line">            noname but not nobody</span><br><span class="line"></span><br><span class="line">This miner can run as root or user :)</span><br><span class="line"></span><br><span class="line">Simple &amp; easy to use. No naughty backdoor.</span><br><span class="line"></span><br><span class="line">Commands :</span><br><span class="line">----------</span><br><span class="line">1. Create config.json first, use : ./mkcfg &lt;Mining Pool:Port&gt; &lt;Worker ID&gt; &lt;Wallet&gt;</span><br><span class="line">2. Start the mining : ./start</span><br><span class="line"></span><br><span class="line">Note :</span><br><span class="line">------</span><br><span class="line">For proxy, use : ./mkcfg &lt;Mining Pool Proxy:Port&gt; &lt;Worker ID&gt; &lt;Wallet&gt;</span><br><span class="line"></span><br><span class="line">Extra :</span><br><span class="line">------</span><br><span class="line">32       = Change into 32-bit</span><br><span class="line">64       = Change into 64-bit</span><br><span class="line">power-on = Extra command :D</span><br><span class="line"></span><br><span class="line">Source files from https://github.com/xmrig (has no virus except you&#x27;re gay)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><code>dbus/bash</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/e9422ff3a83835b47aac93912eca4de2c5d361d0a743672bf7ae6621ea10c226">VirusTotal</a></li>
<li><code>dbus/hide</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/b21d43db4ea65ac178199d1aed1fea0352de0f268a46fbc13fcb719ce50042c9">VirusTotal</a></li>
<li><code>dbus/power-on</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/738abe5627539b952768e19135db62aac37469e6c9a4f08b29e61bee30ef6cdf">VirusTotal</a><ul>
<li>作为 IRCBot 连接到 <code>#kaiten</code> 频道<blockquote>
<p>“Kaiten”这个名称源自日语，意为“回转寿司”，可能是因为这种恶意软件就像回转寿司那样在受控系统之间“旋转”指令。通过IRC频道，攻击者可以远程控制和指挥受感染的机器进行各种活动，包括但不限于发动DDoS攻击、窃取数据、安装更多的恶意软件等。</p>
<p><strong>“这下服务器变回转寿司了，最美味的一集”</strong> (courtesy @taoky)</p>
</blockquote>
</li>
<li>会把自己假装成 <code>[kworker/0:0]</code></li>
<li>可以执行一系列 DDoS 攻击和 remote code execution 命令</li>
</ul>
</li>
<li><code>xtra/</code>:<ul>
<li><code>centos</code> <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/efebb75160eda563e3684619d0ace367366b18bb180fcdbbdbe83269fd530e28">VirusTotal</a></li>
<li><code>ubuntu</code> <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/137f0a89bd16dd0fcc89229bf6de37a230d49e812b47b4482aff6db45b7ac74a">VirusTotal</a></li>
<li><code>32</code> <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/b63b26edbaf0a95cb34d72cfe5aef3ee3c8a565b98faa1ee51c3694b10720837">VirusTotal</a></li>
<li><code>64</code> <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/a7155491bcde2c4bc89f9f37d03c668e32cdb15ad992dd8c3d96b709b494a542">VirusTotal</a></li>
</ul>
</li>
</ul>
</li>
<li><code>/home/spf/.cpan/</code>: 一个 botnet 程序，里面一堆 Tcl 脚本和一些可执行文件<ul>
<li><code>hide</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/e560ae6672fc7c09bfb72f6a1939f0b03108ed5b0a7d2ef1f5c49211e9d6d02c">VirusTotal</a></li>
<li><code>nobody</code>: 无检出，strings 一把看起来像 Tcl 解释器 + 一些奇怪东西，<a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/3fcfaa232e3471c5d40c9396507291d3be34eaafb60f44fd243f23974bd5f001">VirusTotal</a></li>
</ul>
</li>
<li><code>/dev/shm/.m-1013/dbus-collector</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/21c6dfcbd865b57cf5a15f4dc9498e378a7ccec7bbea9ff446884a9b5cb572ec/">VirusTotal</a></li>
<li><code>/x</code>: 端口扫描和 SSH 暴力攻击程序<ul>
<li><code>x/ban</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/2ef26484ec9e70f9ba9273a9a7333af195fb35d410baf19055eacbfa157ef251">VirusTotal</a></li>
<li><code>x/m</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/9aa8a11a52b21035ef7badb3f709fa9aa7e757788ad6100b4086f1c6a18c8ab2">VirusTotal</a></li>
<li><code>x/SSH</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/6163a3ca3be7c3b6e8449722f316be66079207e493830c1cf4e114128f4fb6a4">VirusTotal</a></li>
</ul>
</li>
<li><code>/usr/local/lib/dbus-collector/libdbus_x86_64.so</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/2aed4d101703a74dcc0f5c51506cc376136872c864fc0484a5684cda9c81685b">VirusTotal</a><ul>
<li>尝试隐藏 <code>dbus_collector</code>，通过 hook readdir{64} 并且解析是否是对 <code>/proc</code> 的列目录；如果是，则返回去掉自己结果的列目录结果，从而达到在 ps 和 htop 等工具中隐藏的目的</li>
</ul>
</li>
<li><code>/usr/local/lib/network.so</code>: <a target="_blank" rel="noopener" href="https://www.virustotal.com/gui/file/987d390480b55dcf61e18106b326e706a7a14c7cb6c8f13c35a5b90e068166b6">VirusTotal</a><ul>
<li>尝试隐藏自己，通过 hook readdir{64} 并且解析是否是对 <code>/proc</code> 的列目录；如果是，则返回去掉自己结果的列目录结果，从而达到在 ps 和 htop 等工具中隐藏的目的</li>
</ul>
</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol>
<li>病毒已经有 root 权限</li>
<li>由于发现的比较晚，很多日志 rotate 了，并且日志没有配置实时发送到远程服务器等，导致基本很难断定最初的入侵是什么时候发生的。不过基本可以确定，病毒最早在 1 月 28 日或之前就已经黑进系统了。</li>
<li>系统里面一共有四种类型的病毒：挖矿病毒，DDoS肉鸡病毒，远程控制病毒，SSH扫描病毒；同时，有病毒有隐藏功能，会在 &#x2F;etc&#x2F;ld.so.preload 里面写上自己的动态库，导致所有动态链接的程序运行前均调用病毒程序</li>
<li>远程控制病毒会互相连接，并且存在通过authorized_keys互相跳转的可能性；但是auth.log已经看不到那么远的日志了，可能是被rotate或者删除了</li>
<li>可以通过publickey方式登陆服务器的账户最好检查一下自己的主机是否已经中毒（因为publickey跳转是一种可能的感染路径，虽然没有读 code 证实）</li>
</ol>
<p>远程控制病毒用的是 IRC 和黑客以及其他节点保持连接，并且存在对方进一步下载其它payload（比如，勒索病毒）的可能性。</p>
<blockquote>
<p>此时只能建议大家赶紧备份数据到自己的机器，同时注意服务器上所有的可执行程序都应该认为是<em>不可信任的</em>：即，存在被病毒感染的可能性。有些存在任意代码执行的文件格式也存在被入侵的理论可能（比如 torch 非 safetensor 的 checkpoint 文件）</p>
</blockquote>

      
     <!-- by blair add this if sentence at 20160725 -->
      <br>
      
<!-- <div id="bottom-donation-section"> -->
<!-- <span style="font-size: 1.0em; padding:0em 1em 0.5em 1em; margin: 0 auto;">
  <strong style="vertical-align: top;">分享到:</strong>
    <div class="j_handlclick"  style="background: url(/images/logos/share_facebook_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://www.facebook.com/sharer/sharer.php?u=" target="_blank">
    </div>
    <div class="j_handlclick"  style="background: url(/images/logos/share_twitter_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://twitter.com/intent/tweet?url=" target="_blank">
    </div>
    <div class="j_handlclick"  style="background: url(/images/logos/share_line_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://www.addtoany.com/add_to/line?linkurl=" target="_blank">
    </div>
    <div class="j_handlclick"  style="background: url(/images/logos/share_wechat_icon.jpg);background-size: contain;display: inline-block; width:50px; height:50px" href="https://api.addthis.com/oexchange/0.8/forward/wechat/offer?url=" target="_blank">
    </div>
  <br>  
  <br>  
  &nbsp;&nbsp;如果您觉得这篇文章对您的学习很有帮助, 请您也分享它, 让它能再次帮助到更多的需要学习的人.
您的<a href="/support/"><strong>支持</strong></a>将鼓励我继续创作 !
  <br>  

</span> -->
<!--
<h3 id="bottom-donation-title">支持 让文章变得更优质</h3>
<div>
<a id="bottom-donation-button" href="/support">点我 赞助 作者</a>
</div>
-->
<!-- </div> -->
<!-- <div class="well"> -->
  <!--
  原创文章，转载请注明： 转载自<a target="_blank" rel="noopener" href="http://52binge.github.io"> Blair Chan's Blog</a>，作者：
  <a href="/about">Blair Chan</a> <br>
  -->
  <!-- 本文基于<a target="_blank" title="Creative Commons Attribution 4.0 international License" href="https://creativecommons.org/licenses/by-nc/4.0/">署名4.0国际许可协议</a>发布，转载请保留本文署名和文章链接。 如您有任何授权方面的协商，请邮件联系我。 -->
<!-- </div> -->
 <!-- by blair add 160724-->
    
    </div>
    
      <div class="article-toc">
        <h3>Contents</h3>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E6%B0%B4%E8%B4%A6"><span class="toc-text">流水账</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%83%85%E5%86%B5%E4%BB%8B%E7%BB%8D"><span class="toc-text">情况介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E8%BF%87%E7%A8%8B"><span class="toc-text">分析过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E5%93%AA%E4%B8%AA%E8%BF%9B%E7%A8%8B%E5%9C%A8%E5%8F%91%E5%87%BA-DNS-%E8%AF%B7%E6%B1%82"><span class="toc-text">确定哪个进程在发出 DNS 请求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cron-%E6%97%A5%E5%BF%97%E6%9A%B4%E9%9C%B2%E7%9A%84%E5%86%85%E5%AE%B9"><span class="toc-text">cron 日志暴露的内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-text">用户账户的信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E5%92%8C%E6%96%87%E4%BB%B6%E4%BF%AE%E6%94%B9%E6%97%B6%E9%97%B4"><span class="toc-text">日志和文件修改时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%BC%82%E5%B8%B8%E6%96%87%E4%BB%B6"><span class="toc-text">其他异常文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crontab-%E5%88%86%E6%9E%90"><span class="toc-text">crontab 分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-text">功能分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol>
      </div>
    
    
      <footer class="article-footer">
        <!-- <div class="well" style="width:100px; height:30px;"></div>  by blair-->
        
 <!-- by blair add 160724-->
        <!--
        <div style="width:100px; height:30px;"></div> by blair add 160724
        -->
        

      </footer>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/tailscale-howto/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title"><span>&lt;</span>&nbsp;
        
          Tailscale 服务部署快速参考
        
      </div>
    </a>
  
  
    <a href="/mesa-radv-digestion/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Mesa radv 源码阅读（一）: 如何跟踪图形栈、Vulkan Loader、Mesa 派发机制&nbsp;<span>&gt;</span></div>
    </a>
  
</nav>

  
</article>

</section>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2025 Libre Liu&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a target="_blank" rel="noopener" href="http://github.com/52binge/hexo-theme-blairos">blairos</a>
    </div>
  </div>
</footer>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX"],
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$']],
      processEscapes: true
    }
  });
</script>
<script>
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$']],
      processEscapes: true,
    },
    options: {
    renderActions: {
      findScript: [10, function (doc) {
        for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
          const display = !!node.type.match(/; *mode=display/);
          const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
          const text = document.createTextNode('');
          node.parentNode.replaceChild(text, node);
          math.start = {node: text, delim: '', n: 0};
          math.end = {node: text, delim: '', n: 0};
          doc.math.push(math);
        }
      }, '']
    }
  }
  };
</script>
<script type="text/javascript" id="MathJax-script" src="/js/mathjax/tex-chtml.js">
</script>

    

<script src="/js/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


  </div>
</body>
</html>
